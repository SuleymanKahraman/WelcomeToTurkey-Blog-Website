<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />

  <title>WelcomeTOTurkey - Contacts</title>
  <meta content="" name="description" />
  <meta content="" name="keywords" />

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon" />
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;500&family=Inter:wght@400;500&family=Playfair+Display:ital,wght@0,400;0,700;1,400;1,700&display=swap"
    rel="stylesheet" />

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet" />
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet" />
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet" />
  <link href="assets/vendor/aos/aos.css" rel="stylesheet" />

  <!-- Template Main CSS Files -->
  <link href="assets/css/variables.css" rel="stylesheet" />
  <link href="assets/css/main.css" rel="stylesheet" />

  <!-- =======================================================
  * Template Name: ZenBlog
  * Updated: Mar 10 2023 with Bootstrap v5.2.3
  * Template URL: https://bootstrapmade.com/zenblog-bootstrap-blog-template/
  * Author: BootstrapMade.com
  * License: https:///bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>
  <!-- ======= Header ======= -->
  <header id="header" class="header d-flex align-items-center fixed-top">
    <div class="container-fluid container-xl d-flex align-items-center justify-content-between">
      <a href="index.html" class="logo d-flex align-items-center">
        <h1>WelcomeTOTurkey</h1>
      </a>
      <div class="position-relative">
        <nav id="navbar" class="navbar">
          <ul id="category-list">

          </ul>
        </nav>
      </div>
      <div class="d-flex align-items-center mx-3">
        <a href="#" class="mx-2"><span class="bi bi-facebook"></span></a>
        <a href="#" class="mx-2"><span class="bi bi-twitter"></span></a>
        <a href="#" class="mx-2"><span class="bi bi-instagram"></span></a>
        <i class="bi bi-list mobile-nav-toggle"></i>
        <a href="login.html" class="mx-2" id="login-button"><span class="bi bi-door-open"></span></a>
        <a href="#" class="dropdown">
          <div id="login" style="display: none">
            <button class="dropdown button"><span id="fName">sdada</span></button>
            <div class="dropdown-content">
              <button onclick="logout()">Logout</button>
            </div>
          </div>
        </a>
        <a href="/admin.html" style="display: none;" id="adminPageButton">
          <i class="fa-solid fa-right-to-bracket fa-beat"></i></a>
      </div>

    </div>

  </header>
  <!-- End Header -->

  <main id="main">
    <section>
      <div class="container">
        <div class="row">
          <div class="col-md-12" data-aos="fade-up">
            <h3 class="category-title">
              Category: <span id="categoryTitle"></span>
            </h3>
            <div id="blogs">
              <p>Bu kategoriye ait yazı bulunamadı...</p>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
  <!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer" class="footer">
    <div class="footer-content">
      <div class="container">
        <div class="row g-5">
          <div class="col-lg-4">
            <h3 class="footer-heading">About WelcomeTOTurkey</h3>
            <p>
              "Merhaba! Welcome to our website that provides insights into
              living in Turkey. Our website is designed to cater to people who
              are thinking of living in Turkey or already live here. We offer
              a range of articles covering topics such as culture, history,
              cuisine, and daily life in Turkey. Our aim is to provide a
              comprehensive resource for anyone looking to gain a deeper
              understanding of Turkish society and the unique aspects of
              living in this beautiful country. Join us on this journey to
              explore Turkey and discover everything it has to offer!"
            </p>
          </div>
          <div class="col-6 col-lg-2" style="margin-left: 100px;">
            <h3 class="footer-heading">Navigation</h3>
            <ul class="footer-links list-unstyled" id="category-list-footer">

            </ul>
          </div>
          <div class="col-lg-4" style="margin-left: 80px;">
            <h3 class="footer-heading">Contacts</h3>
            <ul class="contact-info">
              <li><i class="bi bi-envelope"></i> Email: contact@example.com</li>
              <li><i class="bi bi-geo-alt"></i> Address: 1991 Sk. Bağlıca Mh., Ankara, TURKEY</li>
              <li><i class="bi bi-telephone"></i> Phone: 0312 326 98 37</li>
            </ul>
            <div style="margin-left: 30%; margin-top: 20%;">
              <a href="https://twitter.com/example"><i class="bi bi-twitter" style="color: white;"></i></a>
              <a href="https://www.facebook.com/example"><i class="bi bi-facebook" style="color: white;"></i></a>
              <a href="https://plus.google.com/example"><i class="bi bi-google" style="color: white;"></i></a>
            </div>
          </div>
          <div class="footer-legal">
            <div class="container">
              <div class="row justify-content-between">
                <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                  <div class="copyright">
                    © Copyright <strong><span>WelcomeTOTurkey</span></strong>. All Rights Reserved
                  </div>
                </div>
                <div class="col-md-6"></div>
              </div>
            </div>
          </div>
  </footer>

  <!-- Vendor JS Files -->
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>
  <script>
    var firstName = window.localStorage.getItem("firstName");
    var userType = window.localStorage.getItem('userType');
    var adminPageButton = document.getElementById('adminPageButton');
    var loginButton = document.getElementById("login-button");
    if (userType === 'Admin') {
      adminPageButton.style.display = 'block';
    }
    var login = document.getElementById("login");
    if (firstName) {
      login.style.display = "block";
      document.getElementById("fName").innerHTML = firstName;
      loginButton.style.display = "none";
    } else {
      login.style.display = "none";
    }
    /* Authorizing */
    var token = window.localStorage.getItem("token");
    axios.defaults.headers.common["Authorization"] = `Bearer ${token}`;
    let categoryId;
    const params = new Proxy(new URLSearchParams(window.location.search), {
      get: (searchParams, prop) => searchParams.get(prop),
    });
    if (params.categoryId) {
      categoryId = params.categoryId;
    } else {
      window.location.href = "/index.html";
    }
    loadCategories();
    loadBlogs();
    function loadBlogs() {
      if (!categoryId) {
        return;
      }
      axios
        .get(
          `https://localhost:7202/api/blog/get-blogs-by-categoryid/${categoryId}`
        )
        .then((response) => {
          var contentDiv = document.getElementById("blogs");
          var categoryTitle = document.getElementById("categoryTitle");
          categoryTitle.innerHTML = "";
          contentDiv.innerHTML = "";
          if (response.data.length == 0) {
            contentDiv.innerHTML = "İlgili kategori için yazı bulunamadı...";
          }
          response.data.forEach((blog) => {
            if (categoryTitle.innerHTML == "") {
              categoryTitle.innerHTML = blog.category;
            }
            contentDiv.innerHTML += `<div class="d-md-flex post-entry-2 half">
                  <a href="http://127.0.0.1:5500/single-post.html?blogid=${blog.blogId}" class="me-4 thumbnail d-flex justify-content-center align-items-center">
                    <img
                      src="${blog.photo != null
                ? "data:image/jpeg;base64," + blog.photo
                : "assets\\img\\noimage.png"
              }"
                      alt=""
                      width="350"
                      height="250"
                    />
                  </a>
                  <div >
                    <div class="post-meta">
                      <span class="date">${blog.category}</span>
                      <span class="mx-1">&bullet;</span>
                      <span>${blog.publishDate}</span>
                    </div>
                    <h3>
                      <a href="http://127.0.0.1:5500/single-post.html?blogid=${blog.blogId}"
                        >${blog.title}</a
                      >
                    </h3>
                    <p>
                      ${blog.summary}
                    </p>
                  </div>
                </div>`;
          });
        });
    }
    function loadCategories() {
      const listElement = document.getElementById("category-list");
      const listForFooter = document.getElementById('category-list-footer');
      axios
        .get(`https://localhost:7202/api/admin/list-category-with-Id`)
        .then((response) => {
          categories = response.data;
          categories.forEach((element) => {
            listElement.innerHTML += `<li><a href="category.html?categoryId=${element.categoryId}">${element.categoryName}</a></li>`
            listForFooter.innerHTML += `<li><a href="category.html?categoryId=${element.categoryId}">${element.categoryName}</a></li>`

          });
        })
        .catch((error) => {
          console.log(error);
          alert("Do Not Happen!!!");
        });
    }
    function logout() {
      localStorage.clear();
      login.style.display = "none";
      adminPageButton.style.display = "none";
      window.location.reload();
    }


  </script>
</body>

</html>